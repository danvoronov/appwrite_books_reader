<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REM by Gemini - –í–µ–± –í–µ—Ä—Å–∏—è</title>
    <link rel="stylesheet" href="styles.css">
    <script src="marked.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- –®–∞–≥ 1: –í—ã–±–æ—Ä –∫–Ω–∏–≥–∏ -->
        <div id="step1" class="step active">
            <div class="card">
                <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
                    <h2 style="margin:0;">üìñ –í—ã–±–µ—Ä–∏—Ç–µ –∫–Ω–∏–≥—É</h2>
                    <button class="btn btn-secondary" id="openCalendarBtn">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å —á—Ç–µ–Ω–∏—è</button>
                </div>
                <div id="booksContainer">
                    <div class="loading">–ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥...</div>
                </div>
            </div>
        </div>

        <!-- –®–∞–≥ 2: –í—ã–±–æ—Ä –≥–ª–∞–≤ -->
        <div id="step2" class="step">
            <div class="card">
                <div class="chapter-header">
                    <button class="btn btn-danger" id="backToBooks">‚Üê –ù–∞–∑–∞–¥</button>
                    <div id="bookInfo" class="book-title-inline"></div>
                </div>
                <div class="chapter-controls-header">
                    <h2>üìù –í—ã–±–µ—Ä–∏—Ç–µ –≥–ª–∞–≤—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏</h2>
                    <div class="chapter-action-buttons">
                        <button class="btn btn-secondary" id="selectAllBtn">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ</button>
                        <button class="btn btn-secondary" id="selectProcessedBtn">–í—ã–±—Ä–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ</button>
                        <button class="btn btn-secondary" id="deselectAllBtn">–°–Ω—è—Ç—å</button>
                        <button class="btn" id="processBtn" disabled>–û–±—Ä–∞–±–æ—Ç–∞—Ç—å 0 –≥–ª–∞–≤</button>
                    </div>
                </div>
                <div id="chaptersContainer">
                    <div class="loading">–ó–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥–ª–∞–≤–∞—Ö...</div>
                </div>
            </div>
        </div>
        
        <!-- –®–∞–≥ 3: –ß–∏—Ç–∞–ª–∫–∞ -->
        <div id="step3" class="step">
            <div class="card">
                <div class="reader-header-inline">
                    <button class="btn btn-secondary" id="backToChaptersFromReader">‚Üê –ù–∞–∑–∞–¥ –∫ –≥–ª–∞–≤–∞–º</button>
                    <div class="reader-title-inline">
                        <select id="readerChapterSelect" class="reader-chapter-select">
                            <option>–ó–∞–≥—Ä—É–∑–∫–∞...</option>
                        </select>
                        <button id="nextChapterBtn" class="btn btn-secondary btn-next-chapter" title="–°–ª–µ–¥—É—é—â–∞—è –≥–ª–∞–≤–∞">‚Üí</button>
                        <span id="readerBookTitleSmall" class="reader-book-title-small"></span>
                    </div>
                    <div class="reader-controls">
                        <button id="requestTagsBtn" class="btn" style="margin-left:8px;">–†–∞–∑–º–µ—Ç–∏—Ç—å</button>
<span id="requestTagsStatus" style="margin-left:8px; font-size: 0.9rem; color: #666;"></span>
                        <div class="typo-control" title="–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞">
                            <button class="typo-btn" id="fontDec">A‚àí</button>
                            <button class="typo-btn" id="fontInc">A+</button>
                        </div>
                        <div class="typo-control" title="–ú–µ–∂—Å—Ç—Ä–æ—á–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª">
                            <button class="typo-btn" id="lhDec">‚àí</button>
                            <button class="typo-btn" id="lhInc">Ôºã</button>
                        </div>
                    </div>
                </div>
                <div class="reader-summary" id="readerSummary" style="display:none;"></div>
                <div class="reader-meta" id="readerMeta" style="display:none;"></div>
                <div class="reader-layout">
                    <div class="reader-main" id="readerMain">
                        <div class="loading">‚è≥ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—Å—Ç –≥–ª–∞–≤—ã...</div>
                    </div>
                    <aside class="reader-side" id="readerSide"></aside>
                </div>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ -->
        <div id="processingModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>‚öôÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–ª–∞–≤</h3>
                    <button class="modal-close" id="closeModal">&times;</button>
                </div>
                <div class="modal-body">
                    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
                    <div class="progress-bar-container" id="progressBarContainer">
                        <div class="progress-info">
                            <span id="progressText">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞...</span>
                            <span id="progressPercentage">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill" id="progressBarFill"></div>
                        </div>
                        <div class="progress-details">
                            <span id="currentChapter">-</span>
                            <span id="chapterProgress">-</span>
                        </div>
                    </div>
                    
                    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
                    <div class="processing-controls" style="margin-bottom: 15px;">
                        <button class="btn btn-danger" id="stopProcessingBtn">‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                    </div>
                    
                    <!-- –õ–æ–≥ -->
                    <div class="progress-log" id="progressLog">–û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <script type="module">
        // –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        import { BookProcessor } from './modules/BookProcessor.js';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ–≥–¥–∞ DOM –∑–∞–≥—Ä—É–∂–µ–Ω
        document.addEventListener('DOMContentLoaded', () => {
            window.bookProcessor = new BookProcessor();
            console.log('–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
        });
    </script>
</body>
</html>